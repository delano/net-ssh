<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

	<title>Class: Net::SSH::Service::Forward</title>

	<link rel="stylesheet" href="../../../rdoc.css" type="text/css" media="screen" />

	<script src="../../../js/jquery.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../../../js/thickbox-compressed.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../../../js/quicksearch.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../../../js/darkfish.js" type="text/javascript"
		charset="utf-8"></script>

</head>
<body class="class">

	<div id="metadata">
		<div id="file-metadata">
			<div id="file-list-section" class="section">
				<h3 class="section-header">In Files</h3>
				<div class="section-body">
					<ul>
					
						<li><a href="../../../lib/net/ssh/service/forward_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/net/ssh/service/forward.rb">lib/net/ssh/service/forward.rb</a></li>
					
					</ul>
				</div>
			</div>

			
		</div>

		<div id="class-metadata">

			<!-- Parent Class -->
			
			<div id="parent-class-section" class="section">
				<h3 class="section-header">Parent</h3>
				
				<p class="link">Object</p>
				
			</div>
			

			<!-- Namespace Contents -->
			

			<!-- Method Quickref -->
			
			<div id="method-list-section" class="section">
				<h3 class="section-header">Methods</h3>
				<ul class="link-list">
					
					<li><a href="#M000220">::new</a></li>
					
					<li><a href="#M000225">#active_locals</a></li>
					
					<li><a href="#M000239">#active_remotes</a></li>
					
					<li><a href="#M000240">#agent</a></li>
					
					<li><a href="#M000244">#auth_agent_channel</a></li>
					
					<li><a href="#M000224">#cancel_local</a></li>
					
					<li><a href="#M000232">#cancel_remote</a></li>
					
					<li><a href="#M000243">#forwarded_tcpip</a></li>
					
					<li><a href="#M000221">#local</a></li>
					
					<li><a href="#M000242">#prepare_client</a></li>
					
					<li><a href="#M000226">#remote</a></li>
					
					<li><a href="#M000231">#remote_to</a></li>
					
				</ul>
			</div>
			

			<!-- Included Modules -->
			
			<div id="includes-section" class="section">
				<h3 class="section-header">Included Modules</h3>
				<ul class="link-list">
				
				
					<li><a class="include" href="../../SSH.html">Net::SSH</a></li>
				
				
				</ul>
			</div>
			
		</div>

		<div id="project-metadata">
			
			
			<div id="fileindex-section" class="section project-section">
				<h3 class="section-header">Files</h3>
				<ul>
				
					<li class="file"><a href="../../../CHANGELOG_rdoc.html">CHANGELOG.rdoc</a></li>
				
					<li class="file"><a href="../../../README_rdoc.html">README.rdoc</a></li>
				
					<li class="file"><a href="../../../THANKS_rdoc.html">THANKS.rdoc</a></li>
				
				</ul>
			</div>
			

			<div id="classindex-section" class="section project-section">
				<h3 class="section-header">Class Index
					<span class="search-toggle"><img src="../../../images/find.png"
						height="16" width="16" alt="[+]"
						title="show/hide quicksearch" /></span></h3>
				<form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
				<fieldset>
					<legend>Quicksearch</legend>
					<input type="text" name="quicksearch" value=""
						class="quicksearch-field" />
				</fieldset>
				</form>

				<ul class="link-list">
				
					<li><a href="../../../Net.html">Net</a></li>
				
					<li><a href="../../../Net/SSH.html">Net::SSH</a></li>
				
					<li><a href="../../../Net/SSH/Authentication.html">Net::SSH::Authentication</a></li>
				
					<li><a href="../../../Net/SSH/Authentication/Agent.html">Net::SSH::Authentication::Agent</a></li>
				
					<li><a href="../../../Net/SSH/Authentication/Agent/Comment.html">Net::SSH::Authentication::Agent::Comment</a></li>
				
					<li><a href="../../../Net/SSH/Authentication/AgentError.html">Net::SSH::Authentication::AgentError</a></li>
				
					<li><a href="../../../Net/SSH/Authentication/AgentNotAvailable.html">Net::SSH::Authentication::AgentNotAvailable</a></li>
				
					<li><a href="../../../Net/SSH/Authentication/Constants.html">Net::SSH::Authentication::Constants</a></li>
				
					<li><a href="../../../Net/SSH/Authentication/KeyManager.html">Net::SSH::Authentication::KeyManager</a></li>
				
					<li><a href="../../../Net/SSH/Authentication/KeyManagerError.html">Net::SSH::Authentication::KeyManagerError</a></li>
				
					<li><a href="../../../Net/SSH/Authentication/Methods.html">Net::SSH::Authentication::Methods</a></li>
				
					<li><a href="../../../Net/SSH/Authentication/Methods/Abstract.html">Net::SSH::Authentication::Methods::Abstract</a></li>
				
					<li><a href="../../../Net/SSH/Authentication/Methods/Hostbased.html">Net::SSH::Authentication::Methods::Hostbased</a></li>
				
					<li><a href="../../../Net/SSH/Authentication/Methods/KeyboardInteractive.html">Net::SSH::Authentication::Methods::KeyboardInteractive</a></li>
				
					<li><a href="../../../Net/SSH/Authentication/Methods/Password.html">Net::SSH::Authentication::Methods::Password</a></li>
				
					<li><a href="../../../Net/SSH/Authentication/Methods/Publickey.html">Net::SSH::Authentication::Methods::Publickey</a></li>
				
					<li><a href="../../../Net/SSH/Authentication/Pageant.html">Net::SSH::Authentication::Pageant</a></li>
				
					<li><a href="../../../Net/SSH/Authentication/Pageant/Socket.html">Net::SSH::Authentication::Pageant::Socket</a></li>
				
					<li><a href="../../../Net/SSH/Authentication/Pageant/Win.html">Net::SSH::Authentication::Pageant::Win</a></li>
				
					<li><a href="../../../Net/SSH/Authentication/Session.html">Net::SSH::Authentication::Session</a></li>
				
					<li><a href="../../../Net/SSH/AuthenticationFailed.html">Net::SSH::AuthenticationFailed</a></li>
				
					<li><a href="../../../Net/SSH/Buffer.html">Net::SSH::Buffer</a></li>
				
					<li><a href="../../../Net/SSH/BufferedIo.html">Net::SSH::BufferedIo</a></li>
				
					<li><a href="../../../Net/SSH/ChannelOpenFailed.html">Net::SSH::ChannelOpenFailed</a></li>
				
					<li><a href="../../../Net/SSH/ChannelRequestFailed.html">Net::SSH::ChannelRequestFailed</a></li>
				
					<li><a href="../../../Net/SSH/Config.html">Net::SSH::Config</a></li>
				
					<li><a href="../../../Net/SSH/Connection.html">Net::SSH::Connection</a></li>
				
					<li><a href="../../../Net/SSH/Connection/Channel.html">Net::SSH::Connection::Channel</a></li>
				
					<li><a href="../../../Net/SSH/Connection/Constants.html">Net::SSH::Connection::Constants</a></li>
				
					<li><a href="../../../Net/SSH/Connection/Session.html">Net::SSH::Connection::Session</a></li>
				
					<li><a href="../../../Net/SSH/Connection/Session/NilChannel.html">Net::SSH::Connection::Session::NilChannel</a></li>
				
					<li><a href="../../../Net/SSH/Connection/Term.html">Net::SSH::Connection::Term</a></li>
				
					<li><a href="../../../Net/SSH/Disconnect.html">Net::SSH::Disconnect</a></li>
				
					<li><a href="../../../Net/SSH/Exception.html">Net::SSH::Exception</a></li>
				
					<li><a href="../../../Net/SSH/HostKeyMismatch.html">Net::SSH::HostKeyMismatch</a></li>
				
					<li><a href="../../../Net/SSH/KeyFactory.html">Net::SSH::KeyFactory</a></li>
				
					<li><a href="../../../Net/SSH/KnownHosts.html">Net::SSH::KnownHosts</a></li>
				
					<li><a href="../../../Net/SSH/Loggable.html">Net::SSH::Loggable</a></li>
				
					<li><a href="../../../Net/SSH/Packet.html">Net::SSH::Packet</a></li>
				
					<li><a href="../../../Net/SSH/PromptMethods.html">Net::SSH::PromptMethods</a></li>
				
					<li><a href="../../../Net/SSH/PromptMethods/Clear.html">Net::SSH::PromptMethods::Clear</a></li>
				
					<li><a href="../../../Net/SSH/PromptMethods/Highline.html">Net::SSH::PromptMethods::Highline</a></li>
				
					<li><a href="../../../Net/SSH/PromptMethods/Termios.html">Net::SSH::PromptMethods::Termios</a></li>
				
					<li><a href="../../../Net/SSH/Proxy.html">Net::SSH::Proxy</a></li>
				
					<li><a href="../../../Net/SSH/Proxy/ConnectError.html">Net::SSH::Proxy::ConnectError</a></li>
				
					<li><a href="../../../Net/SSH/Proxy/Error.html">Net::SSH::Proxy::Error</a></li>
				
					<li><a href="../../../Net/SSH/Proxy/HTTP.html">Net::SSH::Proxy::HTTP</a></li>
				
					<li><a href="../../../Net/SSH/Proxy/SOCKS4.html">Net::SSH::Proxy::SOCKS4</a></li>
				
					<li><a href="../../../Net/SSH/Proxy/SOCKS5.html">Net::SSH::Proxy::SOCKS5</a></li>
				
					<li><a href="../../../Net/SSH/Proxy/UnauthorizedError.html">Net::SSH::Proxy::UnauthorizedError</a></li>
				
					<li><a href="../../../Net/SSH/Service.html">Net::SSH::Service</a></li>
				
					<li><a href="../../../Net/SSH/Service/Forward.html">Net::SSH::Service::Forward</a></li>
				
					<li><a href="../../../Net/SSH/Test.html">Net::SSH::Test</a></li>
				
					<li><a href="../../../Net/SSH/Test/Channel.html">Net::SSH::Test::Channel</a></li>
				
					<li><a href="../../../Net/SSH/Test/Extensions.html">Net::SSH::Test::Extensions</a></li>
				
					<li><a href="../../../Net/SSH/Test/Extensions/BufferedIo.html">Net::SSH::Test::Extensions::BufferedIo</a></li>
				
					<li><a href="../../../Net/SSH/Test/Extensions/Channel.html">Net::SSH::Test::Extensions::Channel</a></li>
				
					<li><a href="../../../Net/SSH/Test/Extensions/IO.html">Net::SSH::Test::Extensions::IO</a></li>
				
					<li><a href="../../../Net/SSH/Test/Extensions/IO/ClassMethods.html">Net::SSH::Test::Extensions::IO::ClassMethods</a></li>
				
					<li><a href="../../../Net/SSH/Test/Extensions/PacketStream.html">Net::SSH::Test::Extensions::PacketStream</a></li>
				
					<li><a href="../../../Net/SSH/Test/Kex.html">Net::SSH::Test::Kex</a></li>
				
					<li><a href="../../../Net/SSH/Test/LocalPacket.html">Net::SSH::Test::LocalPacket</a></li>
				
					<li><a href="../../../Net/SSH/Test/Packet.html">Net::SSH::Test::Packet</a></li>
				
					<li><a href="../../../Net/SSH/Test/RemotePacket.html">Net::SSH::Test::RemotePacket</a></li>
				
					<li><a href="../../../Net/SSH/Test/Script.html">Net::SSH::Test::Script</a></li>
				
					<li><a href="../../../Net/SSH/Test/Socket.html">Net::SSH::Test::Socket</a></li>
				
					<li><a href="../../../Net/SSH/Transport.html">Net::SSH::Transport</a></li>
				
					<li><a href="../../../Net/SSH/Transport/Algorithms.html">Net::SSH::Transport::Algorithms</a></li>
				
					<li><a href="../../../Net/SSH/Transport/CipherFactory.html">Net::SSH::Transport::CipherFactory</a></li>
				
					<li><a href="../../../Net/SSH/Transport/Constants.html">Net::SSH::Transport::Constants</a></li>
				
					<li><a href="../../../Net/SSH/Transport/HMAC.html">Net::SSH::Transport::HMAC</a></li>
				
					<li><a href="../../../Net/SSH/Transport/HMAC/Abstract.html">Net::SSH::Transport::HMAC::Abstract</a></li>
				
					<li><a href="../../../Net/SSH/Transport/HMAC/MD5.html">Net::SSH::Transport::HMAC::MD5</a></li>
				
					<li><a href="../../../Net/SSH/Transport/HMAC/MD5_96.html">Net::SSH::Transport::HMAC::MD5_96</a></li>
				
					<li><a href="../../../Net/SSH/Transport/HMAC/None.html">Net::SSH::Transport::HMAC::None</a></li>
				
					<li><a href="../../../Net/SSH/Transport/HMAC/SHA1.html">Net::SSH::Transport::HMAC::SHA1</a></li>
				
					<li><a href="../../../Net/SSH/Transport/HMAC/SHA1_96.html">Net::SSH::Transport::HMAC::SHA1_96</a></li>
				
					<li><a href="../../../Net/SSH/Transport/IdentityCipher.html">Net::SSH::Transport::IdentityCipher</a></li>
				
					<li><a href="../../../Net/SSH/Transport/Kex.html">Net::SSH::Transport::Kex</a></li>
				
					<li><a href="../../../Net/SSH/Transport/Kex/DiffieHellmanGroup1SHA1.html">Net::SSH::Transport::Kex::DiffieHellmanGroup1SHA1</a></li>
				
					<li><a href="../../../Net/SSH/Transport/Kex/DiffieHellmanGroupExchangeSHA1.html">Net::SSH::Transport::Kex::DiffieHellmanGroupExchangeSHA1</a></li>
				
					<li><a href="../../../Net/SSH/Transport/PacketStream.html">Net::SSH::Transport::PacketStream</a></li>
				
					<li><a href="../../../Net/SSH/Transport/ServerVersion.html">Net::SSH::Transport::ServerVersion</a></li>
				
					<li><a href="../../../Net/SSH/Transport/Session.html">Net::SSH::Transport::Session</a></li>
				
					<li><a href="../../../Net/SSH/Transport/State.html">Net::SSH::Transport::State</a></li>
				
					<li><a href="../../../Net/SSH/Verifiers.html">Net::SSH::Verifiers</a></li>
				
					<li><a href="../../../Net/SSH/Verifiers/Lenient.html">Net::SSH::Verifiers::Lenient</a></li>
				
					<li><a href="../../../Net/SSH/Verifiers/Null.html">Net::SSH::Verifiers::Null</a></li>
				
					<li><a href="../../../Net/SSH/Verifiers/Strict.html">Net::SSH::Verifiers::Strict</a></li>
				
					<li><a href="../../../Net/SSH/Version.html">Net::SSH::Version</a></li>
				
					<li><a href="../../../OpenSSL.html">OpenSSL</a></li>
				
					<li><a href="../../../OpenSSL/BN.html">OpenSSL::BN</a></li>
				
					<li><a href="../../../OpenSSL/PKey.html">OpenSSL::PKey</a></li>
				
					<li><a href="../../../OpenSSL/PKey/DH.html">OpenSSL::PKey::DH</a></li>
				
					<li><a href="../../../OpenSSL/PKey/DSA.html">OpenSSL::PKey::DSA</a></li>
				
					<li><a href="../../../OpenSSL/PKey/PKey.html">OpenSSL::PKey::PKey</a></li>
				
					<li><a href="../../../OpenSSL/PKey/RSA.html">OpenSSL::PKey::RSA</a></li>
				
					<li><a href="../../../String.html">String</a></li>
				
				</ul>
				<div id="no-class-search-results" style="display: none;">No matching classes.</div>
			</div>

			
		</div>
	</div>

	<div id="documentation">
		<h1 class="class">Net::SSH::Service::Forward</h1>

		<div id="description">
			<p>
This class implements various port forwarding services for use by <a
href="../../SSH.html">Net::SSH</a> clients. The <a
href="Forward.html">Forward</a> class should never need to be instantiated
directly; instead, it should be accessed via the singleton instance
returned by <a
href="../Connection/Session.html#M000157">Connection::Session#forward</a>:
</p>
<pre>
  ssh.forward.local(1234, &quot;www.capify.org&quot;, 80)
</pre>

		</div>

		<!-- Constants -->
		

		<!-- Attributes -->
		
		<div id="attribute-method-details" class="method-section section">
			<h3 class="section-header">Attributes</h3>

			
			<div id="session-attribute-method" class="method-detail">
				<a name="session"></a>
				
				<div class="method-heading attribute-method-heading">
					<span class="method-name">session</span><span
						class="attribute-access-type">[R]</span>
				</div>

				<div class="method-description">
				
				<p>
The underlying connection service instance that the port-forwarding
services employ.
</p>
				
				</div>
			</div>
			
		</div>
		

		<!-- Methods -->
		
		<div id="public-class-method-details" class="method-section section">
			<h3 class="section-header">Public Class Methods</h3>

		
			<div id="new-method" class="method-detail ">
				<a name="M000220"></a>

				<div class="method-heading">
				
					<span class="method-name">new</span><span
						class="method-args">(session)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Instantiates a new <a href="Forward.html">Forward</a> service instance atop
the given connection service session. This will register new channel open
handlers to handle the specialized channels that the <a
href="../../SSH.html">SSH</a> port forwarding protocols employ.
</p>
					

					
					<div class="method-source-code"
						id="new-source">
<pre>
    <span class="ruby-comment cmt"># File lib/net/ssh/service/forward.rb, line 24</span>
24:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">session</span>)
25:       <span class="ruby-ivar">@session</span> = <span class="ruby-identifier">session</span>
26:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">logger</span> = <span class="ruby-identifier">session</span>.<span class="ruby-identifier">logger</span>
27:       <span class="ruby-ivar">@remote_forwarded_ports</span> = {}
28:       <span class="ruby-ivar">@local_forwarded_ports</span> = {}
29:       <span class="ruby-ivar">@agent_forwarded</span> = <span class="ruby-keyword kw">false</span>
30: 
31:       <span class="ruby-identifier">session</span>.<span class="ruby-identifier">on_open_channel</span>(<span class="ruby-value str">'forwarded-tcpip'</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">method</span>(<span class="ruby-identifier">:forwarded_tcpip</span>))
32:       <span class="ruby-identifier">session</span>.<span class="ruby-identifier">on_open_channel</span>(<span class="ruby-value str">'auth-agent'</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">method</span>(<span class="ruby-identifier">:auth_agent_channel</span>))
33:       <span class="ruby-identifier">session</span>.<span class="ruby-identifier">on_open_channel</span>(<span class="ruby-value str">'auth-agent@openssh.com'</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">method</span>(<span class="ruby-identifier">:auth_agent_channel</span>))
34:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
			</div>

		
		</div>
	
		<div id="public-instance-method-details" class="method-section section">
			<h3 class="section-header">Public Instance Methods</h3>

		
			<div id="active-locals-method" class="method-detail ">
				<a name="M000225"></a>

				<div class="method-heading">
				
					<span class="method-name">active_locals</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns a list of all active locally forwarded ports. The returned value is
an array of arrays, where each element is a two-element tuple consisting of
the local port and bind address corresponding to the forwarding port.
</p>
					

					
					<div class="method-source-code"
						id="active-locals-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/service/forward.rb, line 101</span>
101:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">active_locals</span>
102:       <span class="ruby-ivar">@local_forwarded_ports</span>.<span class="ruby-identifier">keys</span>
103:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
			</div>

		
			<div id="active-remotes-method" class="method-detail ">
				<a name="M000239"></a>

				<div class="method-heading">
				
					<span class="method-name">active_remotes</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns all active forwarded remote ports. The returned value is an array
of two-element tuples, where the first element is the port on the remote
host and the second is the bind address.
</p>
					

					
					<div class="method-source-code"
						id="active-remotes-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/service/forward.rb, line 159</span>
159:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">active_remotes</span>
160:       <span class="ruby-ivar">@remote_forwarded_ports</span>.<span class="ruby-identifier">keys</span>
161:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
			</div>

		
			<div id="agent-method" class="method-detail ">
				<a name="M000240"></a>

				<div class="method-heading">
				
					<span class="method-name">agent</span><span
						class="method-args">(channel)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Enables <a href="../../SSH.html">SSH</a> agent forwarding on the given
channel. The forwarded agent will remain active even after the channel
closes&#8212;the channel is only used as the transport for enabling the
forwarded connection. You should never need to call this directly&#8212;it
is called automatically the first time a session channel is opened, when
the connection was created with :forward_agent set to true:
</p>
<pre>
   Net::SSH.start(&quot;remote.host&quot;, &quot;me&quot;, :forwrd_agent =&gt; true) do |ssh|
     ssh.open_channel do |ch|
       # agent will be automatically forwarded by this point
     end
     ssh.loop
   end
</pre>
					

					
					<div class="method-source-code"
						id="agent-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/service/forward.rb, line 176</span>
176:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">agent</span>(<span class="ruby-identifier">channel</span>)
177:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@agent_forwarded</span>
178:       <span class="ruby-ivar">@agent_forwarded</span> = <span class="ruby-keyword kw">true</span>
179: 
180:       <span class="ruby-identifier">channel</span>.<span class="ruby-identifier">send_channel_request</span>(<span class="ruby-value str">&quot;auth-agent-req@openssh.com&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">achannel</span>, <span class="ruby-identifier">success</span><span class="ruby-operator">|</span>
181:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">success</span>
182:           <span class="ruby-identifier">debug</span> { <span class="ruby-value str">&quot;authentication agent forwarding is active&quot;</span> }
183:         <span class="ruby-keyword kw">else</span>
184:           <span class="ruby-identifier">achannel</span>.<span class="ruby-identifier">send_channel_request</span>(<span class="ruby-value str">&quot;auth-agent-req&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">a2channel</span>, <span class="ruby-identifier">success2</span><span class="ruby-operator">|</span>
185:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">success2</span>
186:               <span class="ruby-identifier">debug</span> { <span class="ruby-value str">&quot;authentication agent forwarding is active&quot;</span> }
187:             <span class="ruby-keyword kw">else</span>
188:               <span class="ruby-identifier">error</span> { <span class="ruby-value str">&quot;could not establish forwarding of authentication agent&quot;</span> }
189:             <span class="ruby-keyword kw">end</span>
190:           <span class="ruby-keyword kw">end</span>
191:         <span class="ruby-keyword kw">end</span>
192:       <span class="ruby-keyword kw">end</span>
193:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
			</div>

		
			<div id="cancel-local-method" class="method-detail ">
				<a name="M000224"></a>

				<div class="method-heading">
				
					<span class="method-name">cancel_local</span><span
						class="method-args">(port, bind_address="127.0.0.1")</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Terminates an active local forwarded port. If no such forwarded port
exists, this will raise an exception. Otherwise, the forwarded connection
is terminated.
</p>
<pre>
  ssh.forward.cancel_local(1234)
  ssh.forward.cancel_local(1234, &quot;0.0.0.0&quot;)
</pre>
					

					
					<div class="method-source-code"
						id="cancel-local-source">
<pre>
    <span class="ruby-comment cmt"># File lib/net/ssh/service/forward.rb, line 90</span>
90:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cancel_local</span>(<span class="ruby-identifier">port</span>, <span class="ruby-identifier">bind_address</span>=<span class="ruby-value str">&quot;127.0.0.1&quot;</span>)
91:       <span class="ruby-identifier">socket</span> = <span class="ruby-ivar">@local_forwarded_ports</span>.<span class="ruby-identifier">delete</span>([<span class="ruby-identifier">port</span>, <span class="ruby-identifier">bind_address</span>])
92:       <span class="ruby-identifier">socket</span>.<span class="ruby-identifier">shutdown</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
93:       <span class="ruby-identifier">socket</span>.<span class="ruby-identifier">close</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
94:       <span class="ruby-identifier">session</span>.<span class="ruby-identifier">stop_listening_to</span>(<span class="ruby-identifier">socket</span>)
95:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
			</div>

		
			<div id="cancel-remote-method" class="method-detail ">
				<a name="M000232"></a>

				<div class="method-heading">
				
					<span class="method-name">cancel_remote</span><span
						class="method-args">(port, host="127.0.0.1")</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Requests that a remote forwarded port be cancelled. The remote forwarded
port on the remote host, bound to the given address on the remote host,
will be terminated, but not immediately. This method returns immediately
after queueing the request to be sent to the server. If for some reason the
port cannot be cancelled, an exception will be raised (asynchronously).
</p>
<p>
If you want to know when the connection has been cancelled, it will no
longer be present in the <a href="Forward.html#M000239">active_remotes</a>
list. If you want to block until the port is no longer active, you could do
something like this:
</p>
<pre>
  ssh.forward.cancel_remote(1234, &quot;0.0.0.0&quot;)
  ssh.loop { ssh.forward.active_remotes.include?([1234, &quot;0.0.0.0&quot;]) }
</pre>
					

					
					<div class="method-source-code"
						id="cancel-remote-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/service/forward.rb, line 146</span>
146:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cancel_remote</span>(<span class="ruby-identifier">port</span>, <span class="ruby-identifier">host</span>=<span class="ruby-value str">&quot;127.0.0.1&quot;</span>)
147:       <span class="ruby-identifier">session</span>.<span class="ruby-identifier">send_global_request</span>(<span class="ruby-value str">&quot;cancel-tcpip-forward&quot;</span>, <span class="ruby-identifier">:string</span>, <span class="ruby-identifier">host</span>, <span class="ruby-identifier">:long</span>, <span class="ruby-identifier">port</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">success</span>, <span class="ruby-identifier">response</span><span class="ruby-operator">|</span>
148:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">success</span>
149:           <span class="ruby-ivar">@remote_forwarded_ports</span>.<span class="ruby-identifier">delete</span>([<span class="ruby-identifier">port</span>, <span class="ruby-identifier">host</span>])
150:         <span class="ruby-keyword kw">else</span>
151:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">Exception</span>, <span class="ruby-node">&quot;could not cancel remote forward request on #{host}:#{port}&quot;</span>
152:         <span class="ruby-keyword kw">end</span>
153:       <span class="ruby-keyword kw">end</span>
154:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
			</div>

		
			<div id="local-method" class="method-detail ">
				<a name="M000221"></a>

				<div class="method-heading">
				
					<span class="method-name">local</span><span
						class="method-args">(*args)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Starts listening for connections on the local host, and forwards them to
the specified remote host/port via the <a href="../../SSH.html">SSH</a>
connection. This method accepts either three or four arguments. When four
arguments are given, they are:
</p>
<ul>
<li>the local address to bind to

</li>
<li>the local port to listen on

</li>
<li>the remote host to forward connections to

</li>
<li>the port on the remote host to connect to

</li>
</ul>
<p>
If three arguments are given, it is as if the local bind address is
&#8220;127.0.0.1&#8220;, and the rest are applied as above.
</p>
<pre>
  ssh.forward.local(1234, &quot;www.capify.org&quot;, 80)
  ssh.forward.local(&quot;0.0.0.0&quot;, 1234, &quot;www.capify.org&quot;, 80)
</pre>
					

					
					<div class="method-source-code"
						id="local-source">
<pre>
    <span class="ruby-comment cmt"># File lib/net/ssh/service/forward.rb, line 51</span>
51:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">local</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
52:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">3</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">4</span>
53:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;expected 3 or 4 parameters, got #{args.length}&quot;</span>
54:       <span class="ruby-keyword kw">end</span>
55: 
56:       <span class="ruby-identifier">bind_address</span> = <span class="ruby-value str">&quot;127.0.0.1&quot;</span>
57:       <span class="ruby-identifier">bind_address</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\D/</span>
58: 
59:       <span class="ruby-identifier">local_port</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span>.<span class="ruby-identifier">to_i</span>
60:       <span class="ruby-identifier">remote_host</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span>
61:       <span class="ruby-identifier">remote_port</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span>.<span class="ruby-identifier">to_i</span>
62: 
63:       <span class="ruby-identifier">socket</span> = <span class="ruby-constant">TCPServer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">bind_address</span>, <span class="ruby-identifier">local_port</span>)
64: 
65:       <span class="ruby-ivar">@local_forwarded_ports</span>[[<span class="ruby-identifier">local_port</span>, <span class="ruby-identifier">bind_address</span>]] = <span class="ruby-identifier">socket</span>
66: 
67:       <span class="ruby-identifier">session</span>.<span class="ruby-identifier">listen_to</span>(<span class="ruby-identifier">socket</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">server</span><span class="ruby-operator">|</span>
68:         <span class="ruby-identifier">client</span> = <span class="ruby-identifier">server</span>.<span class="ruby-identifier">accept</span>
69:         <span class="ruby-identifier">debug</span> { <span class="ruby-node">&quot;received connection on #{bind_address}:#{local_port}&quot;</span> }
70: 
71:         <span class="ruby-identifier">channel</span> = <span class="ruby-identifier">session</span>.<span class="ruby-identifier">open_channel</span>(<span class="ruby-value str">&quot;direct-tcpip&quot;</span>, <span class="ruby-identifier">:string</span>, <span class="ruby-identifier">remote_host</span>, <span class="ruby-identifier">:long</span>, <span class="ruby-identifier">remote_port</span>, <span class="ruby-identifier">:string</span>, <span class="ruby-identifier">bind_address</span>, <span class="ruby-identifier">:long</span>, <span class="ruby-identifier">local_port</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">achannel</span><span class="ruby-operator">|</span>
72:           <span class="ruby-identifier">achannel</span>.<span class="ruby-identifier">info</span> { <span class="ruby-value str">&quot;direct channel established&quot;</span> }
73:         <span class="ruby-keyword kw">end</span>
74: 
75:         <span class="ruby-identifier">prepare_client</span>(<span class="ruby-identifier">client</span>, <span class="ruby-identifier">channel</span>, <span class="ruby-identifier">:local</span>)
76:   
77:         <span class="ruby-identifier">channel</span>.<span class="ruby-identifier">on_open_failed</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ch</span>, <span class="ruby-identifier">code</span>, <span class="ruby-identifier">description</span><span class="ruby-operator">|</span>
78:           <span class="ruby-identifier">channel</span>.<span class="ruby-identifier">error</span> { <span class="ruby-node">&quot;could not establish direct channel: #{description} (#{code})&quot;</span> }
79:           <span class="ruby-identifier">channel</span>[<span class="ruby-identifier">:socket</span>].<span class="ruby-identifier">close</span>
80:         <span class="ruby-keyword kw">end</span>
81:       <span class="ruby-keyword kw">end</span>
82:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
			</div>

		
			<div id="remote-method" class="method-detail ">
				<a name="M000226"></a>

				<div class="method-heading">
				
					<span class="method-name">remote</span><span
						class="method-args">(port, host, remote_port, remote_host="127.0.0.1")</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Requests that all connections on the given remote-port be forwarded via the
local host to the given port/host. The last argument describes the bind
address on the remote host, and defaults to 127.0.0.1.
</p>
<p>
This method will return immediately, but the port will not actually be
forwarded immediately. If the remote server is not able to begin the
listener for this request, an exception will be raised asynchronously.
</p>
<p>
If you want to know when the connection is active, it will show up in the
<a href="Forward.html#M000239">active_remotes</a> list. If you want to
block until the port is active, you could do something like this:
</p>
<pre>
  ssh.forward.remote(80, &quot;www.google.com&quot;, 1234, &quot;0.0.0.0&quot;)
  ssh.loop { !ssh.forward.active_remotes.include?([1234, &quot;0.0.0.0&quot;]) }
</pre>
					

					
					<div class="method-source-code"
						id="remote-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/service/forward.rb, line 119</span>
119:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remote</span>(<span class="ruby-identifier">port</span>, <span class="ruby-identifier">host</span>, <span class="ruby-identifier">remote_port</span>, <span class="ruby-identifier">remote_host</span>=<span class="ruby-value str">&quot;127.0.0.1&quot;</span>)
120:       <span class="ruby-identifier">session</span>.<span class="ruby-identifier">send_global_request</span>(<span class="ruby-value str">&quot;tcpip-forward&quot;</span>, <span class="ruby-identifier">:string</span>, <span class="ruby-identifier">remote_host</span>, <span class="ruby-identifier">:long</span>, <span class="ruby-identifier">remote_port</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">success</span>, <span class="ruby-identifier">response</span><span class="ruby-operator">|</span>
121:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">success</span>
122:           <span class="ruby-identifier">debug</span> { <span class="ruby-node">&quot;remote forward from remote #{remote_host}:#{remote_port} to #{host}:#{port} established&quot;</span> }
123:           <span class="ruby-ivar">@remote_forwarded_ports</span>[[<span class="ruby-identifier">remote_port</span>, <span class="ruby-identifier">remote_host</span>]] = <span class="ruby-constant">Remote</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>)
124:         <span class="ruby-keyword kw">else</span>
125:           <span class="ruby-identifier">error</span> { <span class="ruby-value str">&quot;remote forwarding request failed&quot;</span> }
126:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">Exception</span>, <span class="ruby-value str">&quot;remote forwarding request failed&quot;</span>
127:         <span class="ruby-keyword kw">end</span>
128:       <span class="ruby-keyword kw">end</span>
129:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
				<div class="aliases">
					Also aliased as: <a href="Forward.html#M000231">remote_to</a>
				</div>
				
			</div>

		
			<div id="remote-to-method" class="method-detail method-alias">
				<a name="M000231"></a>

				<div class="method-heading">
				
					<span class="method-name">remote_to</span><span
						class="method-args">(port, host, remote_port, remote_host="127.0.0.1")</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Alias for <a href="Forward.html#M000226">remote</a>
</p>
					

					
				</div>

				
			</div>

		
		</div>
	
		<div id="private-instance-method-details" class="method-section section">
			<h3 class="section-header">Private Instance Methods</h3>

		
			<div id="auth-agent-channel-method" class="method-detail ">
				<a name="M000244"></a>

				<div class="method-heading">
				
					<span class="method-name">auth_agent_channel</span><span
						class="method-args">(session, channel, packet)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The callback used when an auth-agent channel is requested by the server.
</p>
					

					
					<div class="method-source-code"
						id="auth-agent-channel-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/service/forward.rb, line 253</span>
253:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">auth_agent_channel</span>(<span class="ruby-identifier">session</span>, <span class="ruby-identifier">channel</span>, <span class="ruby-identifier">packet</span>)
254:         <span class="ruby-identifier">info</span> { <span class="ruby-value str">&quot;opening auth-agent channel&quot;</span> }
255:         <span class="ruby-identifier">channel</span>[<span class="ruby-identifier">:invisible</span>] = <span class="ruby-keyword kw">true</span>
256: 
257:         <span class="ruby-keyword kw">begin</span>
258:           <span class="ruby-identifier">agent</span> = <span class="ruby-constant">Authentication</span><span class="ruby-operator">::</span><span class="ruby-constant">Agent</span>.<span class="ruby-identifier">connect</span>(<span class="ruby-identifier">logger</span>)
259:           <span class="ruby-identifier">prepare_client</span>(<span class="ruby-identifier">agent</span>.<span class="ruby-identifier">socket</span>, <span class="ruby-identifier">channel</span>, <span class="ruby-identifier">:agent</span>)
260:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
261:           <span class="ruby-identifier">error</span> { <span class="ruby-node">&quot;attempted to connect to agent but failed: #{e.class.name} (#{e.message})&quot;</span> }
262:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">ChannelOpenFailed</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2</span>, <span class="ruby-value str">&quot;could not connect to authentication agent&quot;</span>)
263:         <span class="ruby-keyword kw">end</span>
264:       <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
			</div>

		
			<div id="forwarded-tcpip-method" class="method-detail ">
				<a name="M000243"></a>

				<div class="method-heading">
				
					<span class="method-name">forwarded_tcpip</span><span
						class="method-args">(session, channel, packet)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The callback used when a new &#8220;forwarded-tcpip&#8221; channel is
requested by the server. This will open a new socket to the host/port
specified when the forwarded connection was first requested.
</p>
					

					
					<div class="method-source-code"
						id="forwarded-tcpip-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/service/forward.rb, line 232</span>
232:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">forwarded_tcpip</span>(<span class="ruby-identifier">session</span>, <span class="ruby-identifier">channel</span>, <span class="ruby-identifier">packet</span>)
233:         <span class="ruby-identifier">connected_address</span>  = <span class="ruby-identifier">packet</span>.<span class="ruby-identifier">read_string</span>
234:         <span class="ruby-identifier">connected_port</span>     = <span class="ruby-identifier">packet</span>.<span class="ruby-identifier">read_long</span>
235:         <span class="ruby-identifier">originator_address</span> = <span class="ruby-identifier">packet</span>.<span class="ruby-identifier">read_string</span>
236:         <span class="ruby-identifier">originator_port</span>    = <span class="ruby-identifier">packet</span>.<span class="ruby-identifier">read_long</span>
237: 
238:         <span class="ruby-identifier">remote</span> = <span class="ruby-ivar">@remote_forwarded_ports</span>[[<span class="ruby-identifier">connected_port</span>, <span class="ruby-identifier">connected_address</span>]]
239: 
240:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">remote</span>.<span class="ruby-identifier">nil?</span>
241:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">ChannelOpenFailed</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">1</span>, <span class="ruby-node">&quot;unknown request from remote forwarded connection on #{connected_address}:#{connected_port}&quot;</span>)
242:         <span class="ruby-keyword kw">end</span>
243: 
244:         <span class="ruby-identifier">client</span> = <span class="ruby-constant">TCPSocket</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">remote</span>.<span class="ruby-identifier">host</span>, <span class="ruby-identifier">remote</span>.<span class="ruby-identifier">port</span>)
245:         <span class="ruby-identifier">info</span> { <span class="ruby-node">&quot;connected #{connected_address}:#{connected_port} originator #{originator_address}:#{originator_port}&quot;</span> }
246: 
247:         <span class="ruby-identifier">prepare_client</span>(<span class="ruby-identifier">client</span>, <span class="ruby-identifier">channel</span>, <span class="ruby-identifier">:remote</span>)
248:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">SocketError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">err</span>
249:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">ChannelOpenFailed</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2</span>, <span class="ruby-node">&quot;could not connect to remote host (#{remote.host}:#{remote.port}): #{err.message}&quot;</span>)
250:       <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
			</div>

		
			<div id="prepare-client-method" class="method-detail ">
				<a name="M000242"></a>

				<div class="method-heading">
				
					<span class="method-name">prepare_client</span><span
						class="method-args">(client, channel, type)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Perform setup operations that are common to all forwarded channels.
<tt>client</tt> is a socket, <tt>channel</tt> is the channel that was just
created, and <tt>type</tt> is an arbitrary string describing the type of
the channel.
</p>
					

					
					<div class="method-source-code"
						id="prepare-client-source">
<pre>
     <span class="ruby-comment cmt"># File lib/net/ssh/service/forward.rb, line 200</span>
200:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">prepare_client</span>(<span class="ruby-identifier">client</span>, <span class="ruby-identifier">channel</span>, <span class="ruby-identifier">type</span>)
201:         <span class="ruby-identifier">client</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">BufferedIo</span>)
202:         <span class="ruby-identifier">client</span>.<span class="ruby-identifier">logger</span> = <span class="ruby-identifier">logger</span>
203: 
204:         <span class="ruby-identifier">session</span>.<span class="ruby-identifier">listen_to</span>(<span class="ruby-identifier">client</span>)
205:         <span class="ruby-identifier">channel</span>[<span class="ruby-identifier">:socket</span>] = <span class="ruby-identifier">client</span>
206: 
207:         <span class="ruby-identifier">channel</span>.<span class="ruby-identifier">on_data</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ch</span>, <span class="ruby-identifier">data</span><span class="ruby-operator">|</span>
208:           <span class="ruby-identifier">ch</span>[<span class="ruby-identifier">:socket</span>].<span class="ruby-identifier">enqueue</span>(<span class="ruby-identifier">data</span>)
209:         <span class="ruby-keyword kw">end</span>
210: 
211:         <span class="ruby-identifier">channel</span>.<span class="ruby-identifier">on_close</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ch</span><span class="ruby-operator">|</span>
212:           <span class="ruby-identifier">debug</span> { <span class="ruby-node">&quot;closing #{type} forwarded channel&quot;</span> }
213:           <span class="ruby-identifier">ch</span>[<span class="ruby-identifier">:socket</span>].<span class="ruby-identifier">close</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">client</span>.<span class="ruby-identifier">closed?</span>
214:           <span class="ruby-identifier">session</span>.<span class="ruby-identifier">stop_listening_to</span>(<span class="ruby-identifier">ch</span>[<span class="ruby-identifier">:socket</span>])
215:         <span class="ruby-keyword kw">end</span>
216: 
217:         <span class="ruby-identifier">channel</span>.<span class="ruby-identifier">on_process</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ch</span><span class="ruby-operator">|</span>
218:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ch</span>[<span class="ruby-identifier">:socket</span>].<span class="ruby-identifier">closed?</span>
219:             <span class="ruby-identifier">ch</span>.<span class="ruby-identifier">info</span> { <span class="ruby-node">&quot;#{type} forwarded connection closed&quot;</span> }
220:             <span class="ruby-identifier">ch</span>.<span class="ruby-identifier">close</span>
221:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">ch</span>[<span class="ruby-identifier">:socket</span>].<span class="ruby-identifier">available</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
222:             <span class="ruby-identifier">data</span> = <span class="ruby-identifier">ch</span>[<span class="ruby-identifier">:socket</span>].<span class="ruby-identifier">read_available</span>(<span class="ruby-value">8192</span>)
223:             <span class="ruby-identifier">ch</span>.<span class="ruby-identifier">debug</span> { <span class="ruby-node">&quot;read #{data.length} bytes from client, sending over #{type} forwarded connection&quot;</span> }
224:             <span class="ruby-identifier">ch</span>.<span class="ruby-identifier">send_data</span>(<span class="ruby-identifier">data</span>)
225:           <span class="ruby-keyword kw">end</span>
226:         <span class="ruby-keyword kw">end</span>
227:       <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
			</div>

		
		</div>
	

	</div>


	<div id="rdoc-debugging-section-dump" class="debugging-section">
	
		<p>Disabled; run with --debug to generate this.</p>
	
	</div>

	<div id="validator-badges">
		<p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
		<p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
			Rdoc Generator</a> 1.1.6</small>.</p>
	</div>

</body>
</html>

